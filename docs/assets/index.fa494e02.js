import{o as c,c as d,a as i,A as W,n as D,w as b,v as T,b as J,F as k,r as I,t as u,d as S,p as $,e as E,f as v,g,h as m,i as Z,j as ee,k as te,l as se,m as ae,q as ne,s as re,I as le,u as ie}from"./vendor.48bd050f.js";const oe=function(){const e=document.createElement("link").relList;if(e&&e.supports&&e.supports("modulepreload"))return;for(const s of document.querySelectorAll('link[rel="modulepreload"]'))r(s);new MutationObserver(s=>{for(const l of s)if(l.type==="childList")for(const n of l.addedNodes)n.tagName==="LINK"&&n.rel==="modulepreload"&&r(n)}).observe(document,{childList:!0,subtree:!0});function a(s){const l={};return s.integrity&&(l.integrity=s.integrity),s.referrerpolicy&&(l.referrerPolicy=s.referrerpolicy),s.crossorigin==="use-credentials"?l.credentials="include":s.crossorigin==="anonymous"?l.credentials="omit":l.credentials="same-origin",l}function r(s){if(s.ep)return;s.ep=!0;const l=a(s);fetch(s.href,l)}};oe();var f=(t,e)=>{const a=t.__vccOpts||t;for(const[r,s]of e)a[r]=s;return a};const ce={name:"AppHeader"},de={class:"header"},_e=i("h1",{class:"header__h1"},"\u041E\u0442\u0447\u0435\u0442\u044B",-1),ue=[_e];function ye(t,e,a,r,s,l){return c(),d("header",de,ue)}var he=f(ce,[["render",ye]]);const A=t=>{let e,a,r;return e=t.getDate(),e<10&&(e="0"+e),a=t.getMonth()+1,a<10&&(a="0"+a),r=t.getFullYear(),e+"."+a+"."+r},x=t=>{let e,a,r;return e=Math.floor(t/3600),a=Math.floor(t/60)-e*60,r=t%60,[e.toString().padStart(2,"0"),a.toString().padStart(2,"0"),r.toString().padStart(2,"0")].join(":")},pe=t=>{if(!t)return 0;let e,a,r;return t=t.split(":"),e=parseInt(t[0])||0,a=parseInt(t[1])||0,r=parseInt(t[2])||0,e*3600+a*60+r},ge=()=>{const t=new Date;return[t,t]},K=()=>{const t=new Date;let e=new Date(t-(t.getDay()-1)*864e5),a=new Date(t-(t.getDay()-1)*864e5+6*864e5);return[e,a]},me=()=>{const t=new Date;let e=new Date(t.getFullYear(),t.getMonth(),1),a=new Date(t.getFullYear(),t.getMonth()+1,0);return[e,a]},fe=()=>{const t=new Date;return new Date(t.getFullYear(),t.getMonth(),1)},U={917:[917,59,19,510,827,953,549,1049],484:[484,609,917,1117,1047],589:["*"],59:["*"]},B=async(t,e)=>{const a=(n,_,y)=>(_.start=y,fetch(n,{method:"post",headers:{"Content-Type":"application/json"},body:JSON.stringify(_)}).then(o=>o.json()));let r=[],s=0,l=null;for(;l===null||s<l;){let n=a(t,e,s);if(l===null){let _=await n;l=parseInt(_.total)}r.push(n),s+=50}return Promise.all(r)},z=async(t,e)=>fetch(t+"/task.elapseditem.getlist",{method:"post",headers:{"Content-Type":"application/json"},body:JSON.stringify({order:{ID:"asc"},filter:e,select:["ID","TASK_ID","SECONDS","CREATED_DATE"],params:{NAV_PARAMS:{nPageSize:0}}})}).then(a=>a.json()).then(a=>a.result),ve=async(t,e)=>B(t+"/tasks.task.list",{order:{ID:"asc"},filter:e,select:["ID","TITLE","GROUP_ID"]}).then(a=>a.reduce((r,s)=>r.concat(s.result.tasks),[])),ke=async(t,e)=>fetch(t+"/sonet_group.get",{method:"post",headers:{"Content-Type":"application/json"},body:JSON.stringify({ORDER:{ID:"asc"},FILTER:e})}).then(a=>a.json()).then(a=>a.result),H=async t=>{const e=Q(t);return U[e]!==void 0?!0:fetch(t+"/user.admin.json",{method:"post",headers:{"Content-Type":"application/json"}}).then(a=>a.json()).then(a=>a.result).catch(()=>!1)},G=async t=>{const e=Q(t);let a={ACTIVE:"true"};return U[e]!==void 0&&!U[e].includes("*")&&(a.ID=U[e]),B(t+"/user.get",{sort:"LAST_NAME",order:"asc",filter:a}).then(r=>r.reduce((s,l)=>s.concat(l.result),[]))},De=async(t,e)=>fetch("https://isdayoff.ru/api/getdata?year="+t+"&month="+e+"&delimeter=|&covid=1").then(a=>a.text()),Q=t=>t.match(/rest\/(\d+)/)[1]||!1;const Ie={data(){return{apiUrl:this.$store.state.weeklyApiUrl,userId:this.$store.state.weeklyUserId,start:this.$store.state.weeklyDateFrom,end:this.$store.state.weeklyDateTo,datePickerInst:!1,users:[],isUserAdmin:!1,isLoading:!1}},created(){this.getUsers()},mounted(){let t={content:"\u0414\u0435\u043D\u044C",onClick:r=>{let s=ge();r.selectDate(s),r.setViewDate(s[0])}},e={content:"\u041D\u0435\u0434\u0435\u043B\u044F",onClick:r=>{let s=K();r.selectDate(s),r.setViewDate(s[0])}},a={content:"\u041C\u0435\u0441\u044F\u0446",onClick:r=>{let s=me();r.selectDate(s),r.setViewDate(s[0])}};this.datePickerInst=new W("[name=dates]",{range:!0,multipleDatesSeparator:" - ",selectedDates:[this.start,this.end],buttons:[t,e,a],toggleSelected:!1,onSelect(r){r.date.length==2&&r.datepicker.hide()}})},watch:{apiUrl(){this.setUserId(),this.getUsers()},users(){this.isLoading=!1}},methods:{async getUsers(){this.apiUrl&&(this.isLoading=!0,this.isUserAdmin=await H(this.apiUrl),this.isUserAdmin?this.users=await G(this.apiUrl):this.users=[])},setSettings(){this.$store.commit("weeklyApiChange",{weeklyApiUrl:this.apiUrl}),this.$store.commit("weeklyUserChange",{weeklyUserId:this.userId}),this.$store.commit("weeklyDateChange",{weeklyDateFrom:this.datePickerInst.selectedDates[0],weeklyDateTo:this.datePickerInst.selectedDates[1]||this.datePickerInst.selectedDates[0]})},setUserId(){if(this.apiUrl){let t=!1;(t=this.apiUrl.match(/rest\/(\d+)/))&&(this.userId=t[1]||!1)}else this.userId=!1}}},R=t=>($("data-v-f23a44fa"),t=t(),E(),t),we={class:"settings__items"},be=R(()=>i("label",{class:"settings__label"},"\u0421\u0442\u0440\u043E\u043A\u0430 API",-1)),Se={key:0,class:"settings__item"},Ae=R(()=>i("label",{class:"settings__label"},"\u041F\u043E\u043B\u044C\u0437\u043E\u0432\u0430\u0442\u0435\u043B\u044C",-1)),Ue=["value"],Te=R(()=>i("div",{class:"settings__item"},[i("label",{class:"settings__label"},"\u041F\u0435\u0440\u0438\u043E\u0434"),i("input",{class:"settings__input",type:"text",name:"dates"})],-1)),Ce={class:"settings__item"};function xe(t,e,a,r,s,l){return c(),d("div",{class:D(["settings",{"is-loading":s.isLoading}])},[i("div",we,[i("div",{class:D(["settings__item",{"settings__item--2":!s.isUserAdmin}])},[be,b(i("input",{"onUpdate:modelValue":e[0]||(e[0]=n=>s.apiUrl=n),class:"settings__input",type:"text"},null,512),[[T,s.apiUrl]])],2),s.isUserAdmin?(c(),d("div",Se,[Ae,b(i("select",{"onUpdate:modelValue":e[1]||(e[1]=n=>s.userId=n),class:"settings__input"},[(c(!0),d(k,null,I(s.users,n=>(c(),d("option",{key:n.ID,value:n.ID},u(n.LAST_NAME)+" "+u(n.NAME)+" ("+u(n.ID)+") ",9,Ue))),128))],512),[[J,s.userId]])])):S("",!0),Te,i("div",Ce,[i("button",{class:"settings__btn",onClick:e[2]||(e[2]=(...n)=>l.setSettings&&l.setSettings(...n))}," \u041F\u0440\u0438\u043C\u0435\u043D\u0438\u0442\u044C ")])])],2)}var $e=f(Ie,[["render",xe],["__scopeId","data-v-f23a44fa"]]);const Ee={},Re={fill:"currentColor",xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 30 30"},qe=i("path",{d:"M 15 3 C 12.031398 3 9.3028202 4.0834384 7.2070312 5.875 A 1.0001 1.0001 0 1 0 8.5058594 7.3945312 C 10.25407 5.9000929 12.516602 5 15 5 C 20.19656 5 24.450989 8.9379267 24.951172 14 L 22 14 L 26 20 L 30 14 L 26.949219 14 C 26.437925 7.8516588 21.277839 3 15 3 z M 4 10 L 0 16 L 3.0507812 16 C 3.562075 22.148341 8.7221607 27 15 27 C 17.968602 27 20.69718 25.916562 22.792969 24.125 A 1.0001 1.0001 0 1 0 21.494141 22.605469 C 19.74593 24.099907 17.483398 25 15 25 C 9.80344 25 5.5490109 21.062074 5.0488281 16 L 8 16 L 4 10 z"},null,-1),Le=[qe];function Fe(t,e){return c(),d("svg",Re,Le)}var X=f(Ee,[["render",Fe]]);const Ne={},Me={fill:"currentColor",xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 6.91 12.58"},Oe=i("polygon",{points:"0.71 12.58 0 11.88 5.5 6.29 0 0.7 0.71 0 6.91 6.29 0.71 12.58"},null,-1),Pe=[Oe];function Ve(t,e){return c(),d("svg",Me,Pe)}var q=f(Ne,[["render",Ve]]);const Ye={components:{IconRefresh:X,IconArrow:q},data(){return{result:[],isLoading:!1}},computed:{settings(){return{apiUrl:this.$store.state.weeklyApiUrl,userId:this.$store.state.weeklyUserId,dateFrom:this.$store.state.weeklyDateFrom,dateTo:this.$store.state.weeklyDateTo}},summChecked(){return this.result.reduce((t,e)=>t+=e.selected?e.seconds:0,0)},summTotal(){return this.result.reduce((t,e)=>t+=e.seconds,0)}},created(){this.getResult()},watch:{settings(){this.getResult()},result(){this.isLoading=!1}},methods:{formatDate:A,formatTime:x,async getResult(){if(!this.settings.apiUrl||!this.settings.userId)return!1;this.isLoading=!0;const[t,e,a]=await this.getResultData();let r={0:{id:0,name:"\u041D\u0435\u0442 \u0434\u043E\u0441\u0442\u0443\u043F\u0430 \u043A \u0433\u0440\u0443\u043F\u043F\u0435",seconds:0,selected:this.result[0]?this.result[0].selected:!1,tasks:{0:{id:0,name:"\u041D\u0435\u0442 \u0434\u043E\u0441\u0442\u0443\u043F\u0430 \u043A \u0437\u0430\u0434\u0430\u0447\u0435 \u0438\u043B\u0438 \u0437\u0430\u0434\u0430\u0447\u0430 \u0443\u0434\u0430\u043B\u0435\u043D\u0430",seconds:0}}}};a.forEach(n=>{r[n.ID]={id:n.ID,name:n.NAME,seconds:0,selected:this.result[n.ID]?this.result[n.ID].selected:!1,tasks:{}}});let s=this.settings.apiUrl.split(/\/+/);s=s[0]+"//"+s[1];let l={0:0};e.forEach(n=>{let _=r[n.groupId],y=_?_.id:0;l[n.id]=y,r[y].tasks[n.id]={id:n.id,name:n.title,seconds:0,link:s+"/company/personal/user/"+this.settings.userId+"/tasks/task/view/"+n.id+"/"}}),t.forEach(n=>{let _=r[l[n.TASK_ID]],y=_?_.id:0,o=r[y].tasks[n.TASK_ID],p=o?o.id:0;r[y].seconds+=parseInt(n.SECONDS),r[y].tasks[p].seconds+=parseInt(n.SECONDS)}),this.result=Object.values(r).filter(n=>(n.tasks=Object.values(n.tasks).filter(_=>_.seconds),n.seconds))},async getResultData(){let t=[],e={USER_ID:this.settings.userId,">=CREATED_DATE":A(this.settings.dateFrom)+" 00:00:00","<=CREATED_DATE":A(this.settings.dateTo)+" 23:59:59"};e.USER_ID&&(t=await z(this.settings.apiUrl,e));let a=[];e={ID:t.map(s=>s.TASK_ID)},e.ID.length&&(a=await ve(this.settings.apiUrl,e));let r=[];return e={ID:a.map(s=>s.groupId)},e.ID.length&&(r=await ke(this.settings.apiUrl,e)),[t,a,r]},collapseItems(t){t.target.closest(".weekly__item").classList.toggle("is-collapse")},collapseAll(t){let e=t.target.closest(".weekly__collapse-all"),a=e.classList.contains("is-collapse");a?(e.classList.remove("is-collapse"),e.querySelector("span").innerText="\u0421\u0432\u0435\u0440\u043D\u0443\u0442\u044C \u0432\u0441\u0435"):(e.classList.add("is-collapse"),e.querySelector("span").innerText="\u0420\u0430\u0437\u0432\u0435\u0440\u043D\u0443\u0442\u044C \u0432\u0441\u0435"),document.querySelectorAll(".weekly__item").forEach(r=>{a?r.classList.remove("is-collapse"):r.classList.add("is-collapse")})}}},je={class:"weekly__header"},We=i("span",null,"\u0421\u0432\u0435\u0440\u043D\u0443\u0442\u044C \u0432\u0441\u0435",-1),Je={key:0,class:"weekly__items"},Ke={class:"weekly__label"},Be=["onUpdate:modelValue"],ze={class:"weekly__tasks"},He=["href"],Ge={key:1,class:"weekly__footer"},Qe={class:"weekly__checked"},Xe={class:"weekly__total"},Ze={key:2,class:"weekly__empty"};function et(t,e,a,r,s,l){const n=v("IconArrow"),_=v("IconRefresh");return c(),d("div",{class:D(["weekly",{"is-loading":s.isLoading}])},[i("div",je,[i("span",{class:"weekly__collapse-all",onClick:e[0]||(e[0]=(...y)=>l.collapseAll&&l.collapseAll(...y))},[g(n),We])]),g(_,{class:"weekly__refresh",title:"\u041E\u0431\u043D\u043E\u0432\u0438\u0442\u044C \u0434\u0430\u043D\u043D\u044B\u0435",onClick:l.getResult},null,8,["onClick"]),s.result.length?(c(),d("div",Je,[(c(!0),d(k,null,I(s.result,y=>(c(),d("div",{key:y.id,class:"weekly__item"},[i("div",Ke,[g(n,{class:"weekly__collapse",title:"\u0421\u0432\u0435\u0440\u043D\u0443\u0442\u044C/\u0440\u0430\u0437\u0432\u0435\u0440\u043D\u0443\u0442\u044C",onClick:l.collapseItems},null,8,["onClick"]),i("b",null,u(y.name),1),m(" ("+u(l.formatTime(y.seconds))+") ",1),b(i("input",{"onUpdate:modelValue":o=>y.selected=o,class:"weekly__checkbox",type:"checkbox",value:"group.id"},null,8,Be),[[Z,y.selected]])]),i("div",ze,[(c(!0),d(k,null,I(y.tasks,o=>(c(),d("div",{key:o.id,class:"weekly__task"},[i("a",{href:o.link,target:"_blank"},u(o.id),9,He),m(" - "+u(o.name)+" ("+u(l.formatTime(o.seconds))+") ",1)]))),128))])]))),128))])):S("",!0),s.result.length?(c(),d("div",Ge,[i("div",Qe," \u0421\u0443\u043C\u043C\u0430 \u0432\u044B\u0431\u0440\u0430\u043D\u043D\u044B\u0445: "+u(l.formatTime(l.summChecked)),1),i("div",Xe," \u0412\u0441\u0435\u0433\u043E \u0437\u0430\u0442\u0440\u0430\u0447\u0435\u043D\u043E: "+u(l.formatTime(l.summTotal)),1)])):S("",!0),s.result.length?S("",!0):(c(),d("div",Ze,"\u0414\u0430\u043D\u043D\u044B\u0445 \u043D\u0435\u0442"))],2)}var tt=f(Ye,[["render",et]]);const st={components:{SettingsWeekly:$e,ReportWeekly:tt}};function at(t,e,a,r,s,l){const n=v("SettingsWeekly"),_=v("ReportWeekly");return c(),d("div",null,[g(n),g(_)])}var nt=f(st,[["render",at]]);const rt={data(){return{apiUrl:this.$store.state.yearlyApiUrl,userId:this.$store.state.yearlyUserId,date:this.$store.state.yearlyDate,datePickerInst:!1,users:[],isUserAdmin:!1,isLoading:!1}},created(){this.getUsers()},mounted(){this.datePickerInst=new W("[name=year]",{view:"years",minView:"years",dateFormat:"yyyy",range:!1,selectedDates:this.date,toggleSelected:!1,onSelect(t){t.datepicker.hide()}})},watch:{apiUrl(){this.setUserId(),this.getUsers()},users(){this.isLoading=!1}},methods:{async getUsers(){this.apiUrl&&(this.isLoading=!0,this.isUserAdmin=await H(this.apiUrl),this.isUserAdmin?this.users=await G(this.apiUrl):this.users=[])},setSettings(){this.$store.commit("yearlyApiChange",{yearlyApiUrl:this.apiUrl}),this.$store.commit("yearlyUserChange",{yearlyUserId:this.userId}),this.$store.commit("yearlyDateChange",{yearlyDate:this.datePickerInst.selectedDates[0]})},setUserId(){if(this.apiUrl){let t=!1;(t=this.apiUrl.match(/rest\/(\d+)/))&&(this.userId=t[1]||!1)}else this.userId=!1}}},L=t=>($("data-v-468e63aa"),t=t(),E(),t),lt={class:"settings__items"},it=L(()=>i("label",{class:"settings__label"},"\u0421\u0442\u0440\u043E\u043A\u0430 API",-1)),ot={key:0,class:"settings__item"},ct=L(()=>i("label",{class:"settings__label"},"\u041F\u043E\u043B\u044C\u0437\u043E\u0432\u0430\u0442\u0435\u043B\u044C",-1)),dt=["value"],_t=L(()=>i("div",{class:"settings__item"},[i("label",{class:"settings__label"},"\u041F\u0435\u0440\u0438\u043E\u0434"),i("input",{class:"settings__input",type:"text",name:"year"})],-1)),ut={class:"settings__item"};function yt(t,e,a,r,s,l){return c(),d("div",{class:D(["settings",{"is-loading":s.isLoading}])},[i("div",lt,[i("div",{class:D(["settings__item",{"settings__item--2":!s.isUserAdmin}])},[it,b(i("input",{class:"settings__input",type:"text","onUpdate:modelValue":e[0]||(e[0]=n=>s.apiUrl=n)},null,512),[[T,s.apiUrl]])],2),s.isUserAdmin?(c(),d("div",ot,[ct,b(i("select",{class:"settings__input","onUpdate:modelValue":e[1]||(e[1]=n=>s.userId=n)},[(c(!0),d(k,null,I(s.users,n=>(c(),d("option",{key:n.ID,value:n.ID},u(n.LAST_NAME)+" "+u(n.NAME)+" ("+u(n.ID)+") ",9,dt))),128))],512),[[J,s.userId]])])):S("",!0),_t,i("div",ut,[i("button",{class:"settings__btn",onClick:e[2]||(e[2]=(...n)=>l.setSettings&&l.setSettings(...n))},"\u041F\u0440\u0438\u043C\u0435\u043D\u0438\u0442\u044C")])])],2)}var ht=f(rt,[["render",yt],["__scopeId","data-v-468e63aa"]]);const pt={components:{IconRefresh:X,IconArrow:q},data(){return{result:[],months:["\u042F\u043D\u0432\u0430\u0440\u044C","\u0424\u0435\u0432\u0440\u0430\u043B\u044C","\u041C\u0430\u0440\u0442","\u0410\u043F\u0440\u0435\u043B\u044C","\u041C\u0430\u0439","\u0418\u044E\u043D\u044C","\u0418\u044E\u043B\u044C","\u0410\u0432\u0433\u0443\u0441\u0442","\u0421\u0435\u043D\u0442\u044F\u0431\u0440\u044C","\u041E\u043A\u0442\u044F\u0431\u0440\u044C","\u041D\u043E\u044F\u0431\u0440\u044C","\u0414\u0435\u043A\u0430\u0431\u0440\u044C"],isLoading:!1,reports:{},openedReport:!1}},computed:{settings(){return{apiUrl:this.$store.state.yearlyApiUrl,userId:this.$store.state.yearlyUserId,date:this.$store.state.yearlyDate,deltaSeconds:this.$store.state.yearlyDeltaSeconds,deltaDays:this.$store.state.yearlyDeltaDays}},totalSeconds(){return this.result.reduce((t,e)=>t+=e.seconds,0)},totalDeltaSeconds(){return this.result.reduce((t,e)=>t+=this.unformatTime(e.deltaSeconds),0)},totalDays(){return this.result.reduce((t,e)=>t+=this.getFloat(e.days),0)},totalDeltaDays(){return this.result.reduce((t,e)=>t+=this.getFloat(e.deltaDays),0)}},mounted(){this.getResult()},watch:{settings(){this.getResult()},result(){this.isLoading=!1}},methods:{formatDate:A,formatTime:x,unformatTime:pe,async getResult(){var y,o,p,F,N,M,O,P;let t=[],e=this.settings.userId,a=this.settings.date.getFullYear(),r=this.settings.deltaSeconds,s=this.settings.deltaDays;this.isLoading=!0;let l=JSON.parse(localStorage.getItem("yearlyDays"));this.months.forEach((h,w)=>{t[w]={k:w,name:h,seconds:0,deltaSeconds:null,days:0,deltaDays:null,result:0,reports:{}}});for(const h of t){let w=await this.getMonthWorkDays(a,h.k+1);t[h.k].days=w,((o=(y=r==null?void 0:r[e])==null?void 0:y[a])==null?void 0:o[h.k])&&(t[h.k].deltaSeconds=x(r[e][a][h.k])),((F=(p=l==null?void 0:l[e])==null?void 0:p[a])==null?void 0:F[h.k])&&!((M=(N=s==null?void 0:s[e])==null?void 0:N[a])==null?void 0:M[h.k])&&(s[e]||(s[e]={}),s[e][a]||(s[e][a]={}),s[e][a][h.k]=w-l[e][a][h.k],localStorage.setItem("yearlyDeltaDays",JSON.stringify(s)),delete l[e][a][h.k],localStorage.setItem("yearlyDays",JSON.stringify(l))),((P=(O=s==null?void 0:s[e])==null?void 0:O[a])==null?void 0:P[h.k])&&(t[h.k].deltaDays=s[e][a][h.k])}let n=[],_={USER_ID:e,">=CREATED_DATE":"01.01."+a+" 00:00:00","<=CREATED_DATE":"31.12."+a+" 23:59:59"};_.USER_ID&&(n=await z(this.settings.apiUrl,_)),n.forEach(h=>{let w=new Date(h.CREATED_DATE);t[w.getMonth()].seconds+=parseInt(h.SECONDS)}),this.fillReports(n),this.result=t,this.recalcResult()},changeSeconds(t,e){var l,n;let a=this.settings.deltaSeconds,r=this.settings.userId,s=this.settings.date.getFullYear();e=this.unformatTime(e),((n=(l=a[r])==null?void 0:l[s])==null?void 0:n[t])!=e&&(a[r]||(a[r]={}),a[r][s]||(a[r][s]={}),e?a[r][s][t]=e:delete a[r][s][t],this.$store.commit("yearlyDeltaSecondsChange",{yearlyDeltaSeconds:a}),this.recalcResult())},changeDays(t,e){var l,n;let a=this.settings.deltaDays,r=this.settings.userId,s=this.settings.date.getFullYear();e=this.getFloat(e),((n=(l=a[r])==null?void 0:l[s])==null?void 0:n[t])!=e&&(a[r]||(a[r]={}),a[r][s]||(a[r][s]={}),e?a[r][s][t]=e:delete a[r][s][t],this.$store.commit("yearlyDeltaDaysChange",{yearlyDeltaDays:a}),this.recalcResult())},recalcResult(){this.result=this.result.map(t=>{let e=this.getFloat(t.seconds)-this.getFloat(this.unformatTime(t.deltaSeconds)),a=this.getFloat(t.days)-this.getFloat(t.deltaDays);return t.result=(Math.ceil(e/60/60/a*100)/100).toFixed(1),t})},fillReports(t){let e={},a=this.settings.date.getFullYear();for(let r=0,s=11;r<=s;r++){e[r]={i:r,days:{}};let l=33-new Date(a,r,33).getDate();for(let n=1;n<=l;n++){let _=new Date(a,r,n);e[r].days[n]={i:n,date:A(_),day:this.getDayName(_.getDay()),seconds:0}}}t.forEach(r=>{let s=new Date(r.CREATED_DATE);e[s.getMonth()].days[s.getDate()].seconds+=parseInt(r.SECONDS)}),this.reports=e},async getMonthWorkDays(t,e){let a=0;return a=(await De(t,e)).split("|").reduce((s,l)=>l!=1?++s:s,0),a},getFloat(t){return parseFloat(String(t||0).replace(",","."))},getDayName(t){switch(t){case 0:return"\u0432\u0441";case 1:return"\u043F\u043D";case 2:return"\u0432\u0442";case 3:return"\u0441\u0440";case 4:return"\u0447\u0442";case 5:return"\u043F\u0442";case 6:return"\u0441\u0431"}},openReport(t){t.target.closest("tr").classList.toggle("is-open")}}},C=t=>($("data-v-7b68b5e3"),t=t(),E(),t),gt={class:"yearly__table"},mt=C(()=>i("thead",null,[i("tr",null,[i("th"),i("th",null,"\u041C\u0435\u0441\u044F\u0446"),i("th",null,"\u0420\u0430\u0431\u043E\u0447\u0435\u0435 \u0432\u0440\u0435\u043C\u044F"),i("th",null,"\u0420\u0430\u0431\u043E\u0447\u0438\u0435 \u0434\u043D\u0438"),i("th",null,"\u0412\u044B\u0440\u0430\u0431\u043E\u0442\u043A\u0430")])],-1)),ft={class:"is-collapse"},vt={class:"is-name"},kt={class:"is-seconds"},Dt=m(" - "),It=["onUpdate:modelValue","onChange","onKeyup"],wt=m(" = "),bt={class:"is-days"},St=m(" - "),At=["onUpdate:modelValue","onChange","onKeyup"],Ut=m(" = "),Tt={class:"is-result"},Ct={class:"yearly__reports"},xt={colspan:"5",class:"is-report"},$t=C(()=>i("td",null,null,-1)),Et=C(()=>i("td",null,null,-1)),Rt={class:"is-seconds-result"},qt=m(" - "),Lt=m(" = "),Ft={class:"is-days-result"},Nt=m(" - "),Mt=m(" = "),Ot=C(()=>i("td",null,null,-1));function Pt(t,e,a,r,s,l){const n=v("IconRefresh"),_=v("IconArrow"),y=ee("mask");return c(),d("div",{class:D(["yearly",{"is-loading":s.isLoading}])},[g(n,{class:"yearly__refresh",title:"\u041E\u0431\u043D\u043E\u0432\u0438\u0442\u044C \u0434\u0430\u043D\u043D\u044B\u0435",onClick:l.getResult},null,8,["onClick"]),i("table",gt,[mt,i("tbody",null,[(c(!0),d(k,null,I(s.result,o=>(c(),d(k,{key:o.k},[i("tr",null,[i("td",ft,[g(_,{class:"yearly__collapse",title:"\u0421\u0432\u0435\u0440\u043D\u0443\u0442\u044C/\u0440\u0430\u0437\u0432\u0435\u0440\u043D\u0443\u0442\u044C",onClick:l.openReport},null,8,["onClick"])]),i("td",vt,u(o.name),1),i("td",kt,[i("span",null,u(l.formatTime(o.seconds)),1),Dt,i("span",null,[b(i("input",{"onUpdate:modelValue":p=>o.deltaSeconds=p,type:"text",onChange:p=>l.changeSeconds(o.k,o.deltaSeconds),onKeyup:p=>l.changeSeconds(o.k,o.deltaSeconds)},null,40,It),[[T,o.deltaSeconds],[y,{regex:"[0-9]*:[0-5][0-9]:[0-5][0-9]"}]])]),wt,i("span",null,[i("b",null,u(l.formatTime(o.seconds-l.unformatTime(o.deltaSeconds))),1)])]),i("td",bt,[i("span",null,u(o.days),1),St,i("span",null,[b(i("input",{"onUpdate:modelValue":p=>o.deltaDays=p,type:"text",onChange:p=>l.changeDays(o.k,o.deltaDays),onKeyup:p=>l.changeDays(o.k,o.deltaDays)},null,40,At),[[T,o.deltaDays],[y,{regex:"[0-9]*[.,]?[0-9]*"}]])]),Ut,i("span",null,[i("b",null,u(o.days-l.getFloat(o.deltaDays)),1)])]),i("td",Tt,[i("b",null,u(o.result),1)])]),i("tr",Ct,[i("td",xt,[(c(!0),d(k,null,I(s.reports[o.k].days,p=>(c(),d("div",{key:p.i},u(p.date)+" - "+u(p.day)+" - "+u(l.formatTime(p.seconds)),1))),128))])])],64))),128))]),i("tfoot",null,[i("tr",null,[$t,Et,i("td",Rt,[i("span",null,u(l.formatTime(l.totalSeconds)),1),qt,i("span",null,u(l.formatTime(l.totalDeltaSeconds)),1),Lt,i("span",null,u(l.formatTime(l.totalSeconds-l.totalDeltaSeconds)),1)]),i("td",Ft,[i("span",null,u(l.totalDays),1),Nt,i("span",null,u(l.totalDeltaDays),1),Mt,i("span",null,u(l.totalDays-l.totalDeltaDays),1)]),Ot])])])],2)}var Vt=f(pt,[["render",Pt],["__scopeId","data-v-7b68b5e3"]]);const Yt={components:{SettingsYearly:ht,ReportYearly:Vt}};function jt(t,e,a,r,s,l){const n=v("SettingsYearly"),_=v("ReportYearly");return c(),d("div",null,[g(n),g(_)])}var Wt=f(Yt,[["render",jt]]);var V="/weekly/assets/1-1.09f385c0.png",Jt="/weekly/assets/1-2.e5e5cff0.png",Kt="/weekly/assets/1-3.e3cc93dd.png",Bt="/weekly/assets/1-4.c0003914.png",zt="/weekly/assets/1-5.f24f91e8.png",Y="/weekly/assets/1-7.d95bb856.png",j="/weekly/assets/1-8.8fefbc02.png",Ht="/weekly/assets/2-2.6cc30f98.png",Gt="/weekly/assets/2-3.cf23ad7c.png";const Qt={components:{IconArrow:q},mounted(){te.bind(this.$refs.container,"[data-fancybox]",{Toolbar:{display:{left:[],middle:[],right:["close"]}}})},methods:{toggleInstruction(t){let e=document.querySelectorAll(".instruction__name"),a=document.querySelectorAll(".instruction__steps");e.forEach(r=>{r.classList.remove("is-open")}),e[t].classList.add("is-open"),a.forEach(r=>{r.classList.remove("is-open")}),a[t].classList.add("is-open")}}},Xt={class:"instruction"},Zt=m(' \u041F\u043E\u043B\u0443\u0447\u0430\u0435\u043C \u043A\u043E\u0434 \u0434\u043B\u044F "\u0421\u0442\u0440\u043E\u043A\u0430 API": '),es=m(" \u0415\u0441\u043B\u0438 \u0434\u0435\u043B\u0430\u0435\u043C \u043F\u0435\u0440\u0432\u044B\u0439 \u0440\u0430\u0437 "),ts=m(" \u0415\u0441\u043B\u0438 \u0443\u0436\u0435 \u0434\u0435\u043B\u0430\u043B\u0438 \u0440\u0430\u043D\u0435\u0435 "),ss=se('<div class="instruction__steps"><div class="instruction__step"><div class="instruction__text"> 1. \u0417\u0430\u0445\u043E\u0434\u0438\u043C \u0432 bitrix24 \u0432 \u043B\u0435\u0432\u043E\u043C \u043C\u0435\u043D\u044E \u0432 \u0440\u0430\u0437\u0434\u0435\u043B <b>&quot;\u0420\u0430\u0437\u0440\u0430\u0431\u043E\u0442\u0447\u0438\u043A\u0430\u043C&quot;</b></div><div class="instruction__img"><img src="'+V+'" data-fancybox></div></div><div class="instruction__step"><div class="instruction__text"> 2. \u0412\u044B\u0431\u0438\u0440\u0430\u0435\u043C \u043F\u0443\u043D\u043A\u0442 <b>&quot;\u0414\u0440\u0443\u0433\u043E\u0435&quot;</b></div><div class="instruction__img"><img src="'+Jt+'" data-fancybox></div></div><div class="instruction__step"><div class="instruction__text"> 3. \u0412\u044B\u0431\u0438\u0440\u0430\u0435\u043C \u043F\u0443\u043D\u043A\u0442 <b>&quot;\u0412\u0445\u043E\u0434\u044F\u0449\u0438\u0439 \u0432\u0435\u0431\u0445\u0443\u043A&quot;</b></div><div class="instruction__img"><img src="'+Kt+'" data-fancybox></div></div><div class="instruction__step"><div class="instruction__text"> 4. \u0423\u043A\u0430\u0437\u044B\u0432\u0430\u0435\u043C \u043A\u0430\u043A\u043E\u0435-\u043D\u0438\u0431\u0443\u0434\u044C \u043F\u043E\u043D\u044F\u0442\u043D\u043E\u0435 \u043D\u0430\u0437\u0432\u0430\u043D\u0438\u0435 \u0434\u043B\u044F \u0432\u0435\u0431\u0445\u0443\u043A\u0430 </div><div class="instruction__img"><img src="'+Bt+'" data-fancybox></div></div><div class="instruction__step"><div class="instruction__text"> 5. \u0412 \u0431\u043B\u043E\u043A\u0435 <b>&quot;\u041D\u0430\u0441\u0442\u0440\u043E\u0439\u043A\u0430 \u043F\u0440\u0430\u0432&quot;</b> \u0432\u044B\u0431\u0438\u0440\u0430\u0435\u043C: <br><i> \u0417\u0430\u0434\u0430\u0447\u0438 (task) <span style="color:red;"> \u0438\u043C\u0435\u043D\u043D\u043E &quot;task&quot;, \u0431\u0435\u0437 &quot;s&quot; \u043D\u0430 \u043A\u043E\u043D\u0446\u0435 </span></i><br><i>\u0420\u0430\u0431\u043E\u0447\u0438\u0435 \u0433\u0440\u0443\u043F\u043F\u044B (sonet_group)</i><br><i>\u041F\u043E\u043B\u044C\u0437\u043E\u0432\u0430\u0442\u0435\u043B\u0438 (user)</i><br><br></div><div class="instruction__img"><img src="'+zt+'" data-fancybox></div></div><div class="instruction__step"><div class="instruction__text"> 6. \u041D\u0430\u0436\u0438\u043C\u0430\u0435\u043C <b>&quot;\u0421\u043E\u0445\u0440\u0430\u043D\u0438\u0442\u044C&quot;</b></div></div><div class="instruction__step"><div class="instruction__text"> 7. \u041A\u043E\u043F\u0438\u0440\u0443\u0435\u043C \u0441\u0442\u0440\u043E\u0447\u043A\u0443 \u0438\u0437 \u043F\u043E\u043B\u044F <b>&quot;\u0412\u0435\u0431\u0445\u0443\u043A \u0434\u043B\u044F \u0432\u044B\u0437\u043E\u0432\u0430 rest api&quot;</b></div><div class="instruction__img"><img src="'+Y+'" data-fancybox></div></div><div class="instruction__step"><div class="instruction__text"> 8. \u0421\u043A\u043E\u043F\u0438\u0440\u043E\u0432\u0430\u043D\u043D\u0443\u044E \u0441\u0442\u0440\u043E\u0447\u043A\u0443 \u0432\u0441\u0442\u0430\u0432\u043B\u044F\u0435\u043C \u0432 \u043F\u043E\u043B\u0435 <b>&quot;\u0421\u0442\u0440\u043E\u043A\u0430 API&quot;</b> \u0438 \u043D\u0430\u0436\u0438\u043C\u0430\u0435\u043C <b>&quot;\u041F\u0440\u0438\u043C\u0435\u043D\u0438\u0442\u044C&quot;</b><br><br> \u0414\u0435\u043B\u0430\u0435\u043C \u044D\u0442\u043E \u043D\u0430 \u0432\u043A\u043B\u0430\u0434\u043A\u0430\u0445 <b>&quot;\u041D\u0435\u0434\u0435\u043B\u044C\u043A\u0430&quot;</b> \u0438 <b>&quot;\u0413\u043E\u0434\u0438\u043A&quot;</b></div><div class="instruction__img"><img src="'+j+'" data-fancybox></div></div><div class="instruction__step"><div class="instruction__finish">\u0413\u043E\u0442\u043E\u0432\u043E. \u0412\u044B \u0432\u0435\u043B\u0438\u043A\u043E\u043B\u0435\u043F\u043D\u044B!</div></div></div><div class="instruction__steps"><div class="instruction__step"><div class="instruction__text"> 1. \u0417\u0430\u0445\u043E\u0434\u0438\u043C \u0432 bitrix24 \u0432 \u043B\u0435\u0432\u043E\u043C \u043C\u0435\u043D\u044E \u0432 \u0440\u0430\u0437\u0434\u0435\u043B <b>&quot;\u0420\u0430\u0437\u0440\u0430\u0431\u043E\u0442\u0447\u0438\u043A\u0430\u043C&quot;</b></div><div class="instruction__img"><img src="'+V+'" data-fancybox></div></div><div class="instruction__step"><div class="instruction__text"> 2. \u0412\u044B\u0431\u0438\u0440\u0430\u0435\u043C \u043F\u0443\u043D\u043A\u0442 <b>&quot;\u0418\u043D\u0442\u0435\u0433\u0440\u0430\u0446\u0438\u0438&quot;</b></div><div class="instruction__img"><img src="'+Ht+'" data-fancybox></div></div><div class="instruction__step"><div class="instruction__text"> 3. \u041D\u0430\u0445\u043E\u0434\u0438\u043C \u043D\u0443\u0436\u043D\u0443\u044E \u0438\u043D\u0442\u0435\u0433\u0440\u0430\u0446\u0438\u044E \u0438 \u043D\u0430\u0436\u0438\u043C\u0430\u0435\u043C <b>&quot;\u0420\u0435\u0434\u0430\u043A\u0442\u0438\u0440\u043E\u0432\u0430\u0442\u044C&quot;</b><br><br><i>\u0418\u043B\u0438 \u043F\u0440\u043E\u0441\u0442\u043E \u0434\u0432\u043E\u0439\u043D\u043E\u0439 \u0449\u0435\u043B\u0447\u043E\u043A \u043F\u043E \u043D\u0443\u0436\u043D\u043E\u0439 \u0441\u0442\u0440\u043E\u043A\u0435</i></div><div class="instruction__img"><img src="'+Gt+'" data-fancybox></div></div><div class="instruction__step"><div class="instruction__text"> 4. \u041A\u043E\u043F\u0438\u0440\u0443\u0435\u043C \u0441\u0442\u0440\u043E\u0447\u043A\u0443 \u0438\u0437 \u043F\u043E\u043B\u044F <b>&quot;\u0412\u0435\u0431\u0445\u0443\u043A \u0434\u043B\u044F \u0432\u044B\u0437\u043E\u0432\u0430 rest api&quot;</b></div><div class="instruction__img"><img src="'+Y+'" data-fancybox></div></div><div class="instruction__step"><div class="instruction__text"> 5. \u0421\u043A\u043E\u043F\u0438\u0440\u043E\u0432\u0430\u043D\u043D\u0443\u044E \u0441\u0442\u0440\u043E\u0447\u043A\u0443 \u0432\u0441\u0442\u0430\u0432\u043B\u044F\u0435\u043C \u0432 \u043F\u043E\u043B\u0435 <b>&quot;\u0421\u0442\u0440\u043E\u043A\u0430 API&quot;</b> \u0438 \u043D\u0430\u0436\u0438\u043C\u0430\u0435\u043C <b>&quot;\u041F\u0440\u0438\u043C\u0435\u043D\u0438\u0442\u044C&quot;</b><br><br> \u0414\u0435\u043B\u0430\u0435\u043C \u044D\u0442\u043E \u043D\u0430 \u0432\u043A\u043B\u0430\u0434\u043A\u0430\u0445 <b>&quot;\u041D\u0435\u0434\u0435\u043B\u044C\u043A\u0430&quot;</b> \u0438 <b>&quot;\u0413\u043E\u0434\u0438\u043A&quot;</b></div><div class="instruction__img"><img src="'+j+'" data-fancybox></div></div><div class="instruction__step"><div class="instruction__finish">\u0413\u043E\u0442\u043E\u0432\u043E. \u0412\u044B \u0432\u0435\u043B\u0438\u043A\u043E\u043B\u0435\u043F\u043D\u044B!</div></div></div>',2);function as(t,e,a,r,s,l){const n=v("IconArrow");return c(),d("div",Xt,[i("ul",null,[i("li",null,[Zt,i("ul",null,[i("li",null,[i("span",{class:"instruction__name",onClick:e[0]||(e[0]=_=>l.toggleInstruction(0))},[es,g(n,{class:"instruction__arrow",title:"\u0421\u0432\u0435\u0440\u043D\u0443\u0442\u044C/\u0440\u0430\u0437\u0432\u0435\u0440\u043D\u0443\u0442\u044C"})])]),i("li",null,[i("span",{class:"instruction__name",onClick:e[1]||(e[1]=_=>l.toggleInstruction(1))},[ts,g(n,{class:"instruction__arrow",title:"\u0421\u0432\u0435\u0440\u043D\u0443\u0442\u044C/\u0440\u0430\u0437\u0432\u0435\u0440\u043D\u0443\u0442\u044C"})])])])])]),ss])}var ns=f(Qt,[["render",as]]);const rs={components:{TabWeekly:nt,TabYearly:Wt,TabInstruction:ns},data(){return{active:0,tabs:[{k:0,name:"\u041D\u0435\u0434\u0435\u043B\u044C\u043A\u0430",content:"TabWeekly"},{k:1,name:"\u0413\u043E\u0434\u0438\u043A",content:"TabYearly"},{k:2,name:"SPACE"},{k:3,name:"\u0418\u043D\u0441\u0442\u0440\u0443\u043A\u0446\u0438\u044F",content:"TabInstruction"}]}},methods:{changeTab(t){this.active=t}}},ls={class:"tabs"},is={class:"tabs__tabs"},os=["onClick"],cs={class:"tabs__contents"},ds=["onClick"];function _s(t,e,a,r,s,l){return c(),d("div",ls,[i("div",is,[(c(!0),d(k,null,I(s.tabs,n=>(c(),d("div",{key:n.k,class:D(["tabs__tab",{"is-active":n.k==s.active,"is-space":n.name=="SPACE"}]),onClick:_=>l.changeTab(n.k)},u(n.name!="SPACE"?n.name:""),11,os))),128))]),i("div",cs,[(c(!0),d(k,null,I(s.tabs,n=>(c(),d("div",{key:n.k,class:D(["tabs__content",{"is-active":n.k==s.active}]),onClick:_=>l.changeTab(n.k)},[(c(),ae(ne(n.content)))],10,ds))),128))])])}var us=f(rs,[["render",_s],["__scopeId","data-v-85ca4516"]]);const ys={name:"App",components:{AppHeader:he,Tabs:us}},hs={class:"reports"};function ps(t,e,a,r,s,l){const n=v("AppHeader"),_=v("Tabs");return c(),d("div",hs,[g(n),g(_)])}var gs=f(ys,[["render",ps]]);const[ms,fs]=K(),vs=fe();var ks=re({state(){return{weeklyApiUrl:localStorage.getItem("weeklyApiUrl")||"",weeklyUserId:localStorage.getItem("weeklyUserId")||"",weeklyDateFrom:ms,weeklyDateTo:fs,yearlyApiUrl:localStorage.getItem("yearlyApiUrl")||"",yearlyUserId:localStorage.getItem("yearlyUserId")||"",yearlyDate:vs,yearlyDeltaDays:JSON.parse(localStorage.getItem("yearlyDeltaDays"))||{},yearlyDeltaSeconds:JSON.parse(localStorage.getItem("yearlyDeltaSeconds"))||{}}},mutations:{weeklyApiChange(t,e){t.weeklyApiUrl=e.weeklyApiUrl,localStorage.setItem("weeklyApiUrl",e.weeklyApiUrl)},weeklyUserChange(t,e){t.weeklyUserId=e.weeklyUserId,localStorage.setItem("weeklyUserId",e.weeklyUserId)},weeklyDateChange(t,e){t.weeklyDateFrom=e.weeklyDateFrom,t.weeklyDateTo=e.weeklyDateTo},yearlyApiChange(t,e){t.yearlyApiUrl=e.yearlyApiUrl,localStorage.setItem("yearlyApiUrl",e.yearlyApiUrl)},yearlyUserChange(t,e){t.yearlyUserId=e.yearlyUserId,localStorage.setItem("yearlyUserId",e.yearlyUserId)},yearlyDateChange(t,e){t.yearlyDate=e.yearlyDate,localStorage.setItem("yearlyDate",e.yearlyDate)},yearlyDeltaDaysChange(t,e){t.yearlyDeltaDays=e.yearlyDeltaDays,localStorage.setItem("yearlyDeltaDays",JSON.stringify(e.yearlyDeltaDays))},yearlyDeltaSecondsChange(t,e){t.yearlyDeltaSeconds=e.yearlyDeltaSeconds,localStorage.setItem("yearlyDeltaSeconds",JSON.stringify(e.yearlyDeltaSeconds))}}}),Ds={install:t=>{t.directive("mask",{mounted:(e,a)=>{le(a.value).mask(e)}})}};ie(gs).use(ks).use(Ds).mount("#app");
